/*!
 * UBM - Web Analytics
 *
 * JavaScript tracking client
 *
 */
if(!this.JSON2){this.JSON2={}}(function(){function f(n){return n<10?"0"+n:n}function objectToJSON(value,key){var objectType=Object.prototype.toString.apply(value);if(objectType==="[object Date]"){return isFinite(value.valueOf())?value.getUTCFullYear()+"-"+f(value.getUTCMonth()+1)+"-"+f(value.getUTCDate())+"T"+f(value.getUTCHours())+":"+f(value.getUTCMinutes())+":"+f(value.getUTCSeconds())+"Z":null}if(objectType==="[object String]"||objectType==="[object Number]"||objectType==="[object Boolean]"){return value.valueOf()}if(objectType!=="[object Array]"&&typeof value.toJSON==="function"){return value.toJSON(key)}return value}var cx=new RegExp("[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]","g"),pattern='\\\\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]',escapable=new RegExp("["+pattern,"g"),gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"){value=objectToJSON(value,key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON2.stringify!=="function"){JSON2.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON2.parse!=="function"){JSON2.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if((new RegExp("^[\\],:{}\\s]*$")).test(text.replace(new RegExp('\\\\(?:["\\\\/bfnrt]|u[0-9a-fA-F]{4})',"g"),"@").replace(new RegExp('"[^"\\\\\n\r]*"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?',"g"),"]").replace(new RegExp("(?:^|:|,)(?:\\s*\\[)+","g"),""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());var _paq=_paq||[],UBM=UBM||(function(){var expireDateTime,plugins={},documentAlias=document,navigatorAlias=navigator,screenAlias=screen,windowAlias=window,urlProtocol=("https:"==documentAlias.location.protocol?"https://":"http://"),hasLoaded=false,registeredOnLoadHandlers=[],encodeWrapper=windowAlias.encodeURIComponent,decodeWrapper=windowAlias.decodeURIComponent,urldecode=unescape,asyncTracker,i,trackInterface="collect";function isDefined(property){var propertyType=typeof property;return propertyType!=="undefined"}function isFunction(property){return typeof property==="function"}function isObject(property){return typeof property==="object"}function isString(property){return typeof property==="string"||property instanceof String}function apply(){var i,f,parameterArray;for(i=0;i<arguments.length;i+=1){parameterArray=arguments[i];f=parameterArray.shift();if(isString(f)){return asyncTracker[f].apply(asyncTracker,parameterArray)}else{return f.apply(asyncTracker,parameterArray)}}}function addEventListener(element,eventType,eventHandler,useCapture){if(element.addEventListener){element.addEventListener(eventType,eventHandler,useCapture);return true}if(element.attachEvent){return element.attachEvent("on"+eventType,eventHandler)}element["on"+eventType]=eventHandler}function executePluginMethod(methodName,callback){var result={},i,pluginMethod;for(i in plugins){if(Object.prototype.hasOwnProperty.call(plugins,i)){pluginMethod=plugins[i][methodName];if(isFunction(pluginMethod)){var pluginResult=pluginMethod(callback);if(pluginResult!=undefined&&pluginResult!=null){for(var p in pluginResult){result[p]=pluginResult[p]}}}}}return result}function beforeUnloadHandler(){var now;executePluginMethod("unload");if(expireDateTime){do{now=new Date()}while(now.getTimeAlias()<expireDateTime)}}function loadHandler(){var i;if(!hasLoaded){hasLoaded=true;executePluginMethod("load");for(i=0;i<registeredOnLoadHandlers.length;i++){registeredOnLoadHandlers[i]()}}return true}function addReadyListener(){var _timer;if(documentAlias.addEventListener){addEventListener(documentAlias,"DOMContentLoaded",function ready(){documentAlias.removeEventListener("DOMContentLoaded",ready,false);loadHandler()})}else{if(documentAlias.attachEvent){documentAlias.attachEvent("onreadystatechange",function ready(){if(documentAlias.readyState==="complete"){documentAlias.detachEvent("onreadystatechange",ready);loadHandler()}});if(documentAlias.documentElement.doScroll&&windowAlias===windowAlias.top){(function ready(){if(!hasLoaded){try{documentAlias.documentElement.doScroll("left")}catch(error){setTimeout(ready,0);return}loadHandler()}}())}}}if((new RegExp("WebKit")).test(navigatorAlias.userAgent)){_timer=setInterval(function(){if(hasLoaded||/loaded|complete/.test(documentAlias.readyState)){clearInterval(_timer);loadHandler()}},10)}addEventListener(windowAlias,"load",loadHandler,false)}function loadScript(src,onLoad){var script=documentAlias.createElement("script");script.type="text/javascript";script.src=src;if(script.readyState){script.onreadystatechange=function(){var state=this.readyState;if(state==="loaded"||state==="complete"){script.onreadystatechange=null;onLoad()}}}else{script.onload=onLoad}documentAlias.getElementsByTagName("head")[0].appendChild(script)}function getReferrer(){var referrer="";try{referrer=windowAlias.top.document.referrer}catch(e){if(windowAlias.parent){try{referrer=windowAlias.parent.document.referrer}catch(e2){referrer=""}}}if(referrer===""){referrer=documentAlias.referrer}return referrer}function getProtocolScheme(url){var e=new RegExp("^([a-z]+):"),matches=e.exec(url);return matches?matches[1]:null}function getHostName(url){var e=new RegExp("^(?:(?:https?|ftp):)/*(?:[^@]+@)?([^:/#]+)"),matches=e.exec(url);return matches?matches[1]:url}function getParameter(url,name){var e=new RegExp("^(?:https?|ftp)(?::/*(?:[^?]+)[?])([^#]+)"),matches=e.exec(url),f=new RegExp("(?:^|&)"+name+"=([^&]*)"),result=matches?f.exec(matches[1]):0;return result?decodeWrapper(result[1]):""}function utf8_encode(argString){return urldecode(encodeWrapper(argString))}function sha1(str){var rotate_left=function(n,s){return(n<<s)|(n>>>(32-s))},cvt_hex=function(val){var str="",i,v;for(i=7;i>=0;i--){v=(val>>>(i*4))&15;str+=v.toString(16)}return str},blockstart,i,j,W=[],H0=1732584193,H1=4023233417,H2=2562383102,H3=271733878,H4=3285377520,A,B,C,D,E,temp,str_len,word_array=[];str=utf8_encode(str);str_len=str.length;for(i=0;i<str_len-3;i+=4){j=str.charCodeAt(i)<<24|str.charCodeAt(i+1)<<16|str.charCodeAt(i+2)<<8|str.charCodeAt(i+3);word_array.push(j)}switch(str_len&3){case 0:i=2147483648;break;case 1:i=str.charCodeAt(str_len-1)<<24|8388608;break;case 2:i=str.charCodeAt(str_len-2)<<24|str.charCodeAt(str_len-1)<<16|32768;break;case 3:i=str.charCodeAt(str_len-3)<<24|str.charCodeAt(str_len-2)<<16|str.charCodeAt(str_len-1)<<8|128;break}word_array.push(i);while((word_array.length&15)!==14){word_array.push(0)}word_array.push(str_len>>>29);word_array.push((str_len<<3)&4294967295);for(blockstart=0;blockstart<word_array.length;blockstart+=16){for(i=0;i<16;i++){W[i]=word_array[blockstart+i]}for(i=16;i<=79;i++){W[i]=rotate_left(W[i-3]^W[i-8]^W[i-14]^W[i-16],1)}A=H0;B=H1;C=H2;D=H3;E=H4;for(i=0;i<=19;i++){temp=(rotate_left(A,5)+((B&C)|(~B&D))+E+W[i]+1518500249)&4294967295;E=D;D=C;C=rotate_left(B,30);B=A;A=temp}for(i=20;i<=39;i++){temp=(rotate_left(A,5)+(B^C^D)+E+W[i]+1859775393)&4294967295;E=D;D=C;C=rotate_left(B,30);B=A;A=temp}for(i=40;i<=59;i++){temp=(rotate_left(A,5)+((B&C)|(B&D)|(C&D))+E+W[i]+2400959708)&4294967295;E=D;D=C;C=rotate_left(B,30);B=A;A=temp}for(i=60;i<=79;i++){temp=(rotate_left(A,5)+(B^C^D)+E+W[i]+3395469782)&4294967295;E=D;D=C;C=rotate_left(B,30);B=A;A=temp}H0=(H0+A)&4294967295;H1=(H1+B)&4294967295;H2=(H2+C)&4294967295;H3=(H3+D)&4294967295;H4=(H4+E)&4294967295}temp=cvt_hex(H0)+cvt_hex(H1)+cvt_hex(H2)+cvt_hex(H3)+cvt_hex(H4);return temp.toLowerCase()}function urlFixup(hostName,href,referrer){if(hostName==="translate.googleusercontent.com"){if(referrer===""){referrer=href}href=getParameter(href,"u");hostName=getHostName(href)}else{if(hostName==="cc.bingj.com"||hostName==="webcache.googleusercontent.com"||hostName.slice(0,5)==="74.6."){href=documentAlias.links[0].href;hostName=getHostName(href)}}return[hostName,href,referrer]}function domainFixup(domain){var dl=domain.length;if(domain.charAt(--dl)==="."){domain=domain.slice(0,dl)}if(domain.slice(0,2)==="*."){domain=domain.slice(1)}return domain}function titleFixup(title){if(!isString(title)){title=title.text||"";var tmp=documentAlias.getElementsByTagName("title");if(tmp&&isDefined(tmp[0])){title=tmp[0].text}}return title}function Tracker(siteId,trackerUrl){var registeredHooks={},locationArray=urlFixup(documentAlias.domain,windowAlias.location.href,getReferrer()),domainAlias=domainFixup(locationArray[0]),locationHrefAlias=locationArray[1],configReferrerUrl=locationArray[2],configRequestMethod="GET",configTrackerUrl=trackerUrl||(urlProtocol+"ci.realsight.cn/ci-receiver/collect"),configTrackerSiteId=siteId||"",configUserId="",configChannelId="",configCustomUrl,configTitle=documentAlias.title,configIPAddress="",configDownloadExtensions="7z|aac|ar[cj]|as[fx]|avi|bin|csv|deb|dmg|docx?|exe|flv|gif|gz|gzip|hqx|jar|jpe?g|js|mp(2|3|4|e?g)|mov(ie)?|ms[ip]|od[bfgpst]|og[gv]|pdf|phps|png|pptx?|qtm?|ra[mr]?|rpm|sea|sit|tar|t?bz2?|tgz|torrent|txt|wav|wm[av]|wpd||xlsx?|xml|z|zip",configHostsAlias=[domainAlias],configIgnoreClasses=[],configDownloadClasses=[],configLinkClasses=[],configTrackerPause=500,configMinimumVisitTime,configHeartBeatTimer,configDiscardHashTag,configInFrame=windowAlias.location!==windowAlias.top.location,configEnableInFrameTrack=false,configCustomData,configCampaignNameParameters=["pk_campaign","ubm_campaign","utm_campaign","utm_source","utm_medium"],configCampaignKeywordParameters=["pk_kwd","ubm_kwd","utm_term"],configCookieNamePrefix="_ubm_",configCookieDomain,configCookieSubDomain=true,configCookiePath,configCookiesDisabled=false,configDoNotTrack,configAutoPageView=true,configCountPreRendered,configConversionAttributionFirstReferrer,configVisitorCookieTimeout=63072000000,configSessionCookieTimeout=1800000,configReferralCookieTimeout=15768000000,customVariables=false,customVariablesPage={},customVariableMaximumLength=2000,browserFeatures={},linkTrackingInstalled=false,activityTrackingInstalled=false,lastActivityTime,lastButton,lastTarget,hash=sha1,domainHash,visitorUUID,configCookieTimeouts={id:configVisitorCookieTimeout,ses:configSessionCookieTimeout,ref:configReferralCookieTimeout,cvar:configSessionCookieTimeout},recResultServiceUrl=urlProtocol+"ci.realsight.cn/prophet-rest/rest/scenario/";function setCookie(cookieName,value,msToExpire,path,domain,secure){if(configCookiesDisabled){return}var expiryDate;if(msToExpire){expiryDate=new Date();expiryDate.setTime(expiryDate.getTime()+msToExpire)}if(domain===undefined&&configCookieSubDomain){var matches=documentAlias.location.hostname.match(/[a-z0-9][a-z0-9\-]+\.[a-z\.]{2,6}$/i),domain=matches?matches[0]:"";domain=((domain)?"; domain=."+domain:"")}documentAlias.cookie=cookieName+"="+encodeWrapper(value)+(msToExpire?";expires="+expiryDate.toGMTString():"")+";path="+(path||"/")+(domain?";domain="+domain:"")+(secure?";secure":"")}function getCookie(cookieName,originallName){if(configCookiesDisabled){return 0}var cookiePattern=new RegExp("(^|;)[ ]*"+cookieName+"=([^;]*)"),cookieMatch=cookiePattern.exec(documentAlias.cookie);if(!cookieMatch&&originallName!==undefined){var oldCookieValue=getCookie(getOldCookieName(originallName));if(oldCookieValue){if(configCookieTimeouts[originallName]){setCookie(getCookieName(originallName),configCookieTimeouts[originallName],configCookiePath,configCookieDomain)}else{setCookie(getCookieName(originallName))}}return oldCookieValue}return cookieMatch?decodeWrapper(cookieMatch[2]):0}function purify(url){var targetPattern;if(configDiscardHashTag){targetPattern=new RegExp("#.*");return url.replace(targetPattern,"")}return url}function resolveRelativeReference(baseUrl,url){var protocol=getProtocolScheme(url),i;if(protocol){return url}if(url.slice(0,1)==="/"){return getProtocolScheme(baseUrl)+"://"+getHostName(baseUrl)+url}baseUrl=purify(baseUrl);if((i=baseUrl.indexOf("?"))>=0){baseUrl=baseUrl.slice(0,i)}if((i=baseUrl.lastIndexOf("/"))!==baseUrl.length-1){baseUrl=baseUrl.slice(0,i+1)}return baseUrl+url}function isSiteHostName(hostName){var i,alias,offset;for(i=0;i<configHostsAlias.length;i++){alias=domainFixup(configHostsAlias[i].toLowerCase());if(hostName===alias){return true}if(alias.slice(0,1)==="."){if(hostName===alias.slice(1)){return true}offset=hostName.length-alias.length;if((offset>0)&&(hostName.slice(offset)===alias)){return true}}}return false}function getImage(request){var image=new Image(1,1);image.onload=function(){};image.src=configTrackerUrl+(configTrackerUrl.indexOf("?")<0?"?":"&")+request}function sendXmlHttpRequest(request){try{var xhr=windowAlias.XMLHttpRequest?new windowAlias.XMLHttpRequest():windowAlias.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null;xhr.open("POST",configTrackerUrl,true);xhr.onreadystatechange=function(){if(this.readyState===4&&this.status!==200){getImage(request)}};xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");xhr.send(request)}catch(e){getImage(request)}}function sendRequest(request,delay){var now=new Date();if(!configDoNotTrack&&(configInFrame?configEnableInFrameTrack:true)){if(configRequestMethod==="POST"){sendXmlHttpRequest("trackinfo="+encodeWrapper(JSON2.stringify(request)))}else{getImage("trackinfo="+encodeWrapper(JSON2.stringify(request)))}expireDateTime=now.getTime()+delay}}function getCookieName(baseName){return configCookieNamePrefix+baseName+"."+configTrackerSiteId}function getOldCookieName(baseName){return configCookieNamePrefix+baseName+"."+configTrackerSiteId+"."+domainHash}function hasCookies(){if(configCookiesDisabled){return"0"}if(!isDefined(navigatorAlias.cookieEnabled)){var testCookieName=getCookieName("testcookie");setCookie(testCookieName,"1");return getCookie(testCookieName,"testcookie")==="1"?"1":"0"}return navigatorAlias.cookieEnabled?"1":"0"}function updateDomainHash(){domainHash=hash((configCookieDomain||domainAlias)+(configCookiePath||"/")).slice(0,4)}function getCustomVariablesFromCookie(){var cookieName=getCookieName("cvar"),cookie=getCookie(cookieName,"cvar");if(cookie.length){cookie=JSON2.parse(cookie);if(isObject(cookie)){return cookie}}return{}}function loadCustomVariables(){if(customVariables===false){customVariables=getCustomVariablesFromCookie()}}function activityHandler(){var now=new Date();lastActivityTime=now.getTime()}function setVisitorIdCookie(uuid){setCookie(getCookieName("id"),uuid,configVisitorCookieTimeout,configCookiePath,configCookieDomain)}function loadVisitorIdCookie(){var now=new Date(),nowTs=Math.round(now.getTime()/1000),id=getCookie(getCookieName("id"),"id"),tmpContainer;if(id){tmpContainer=id.split(".");if(tmpContainer.length>2){tmpContainer.unshift("0")}}else{if(!visitorUUID){visitorUUID=hash((navigatorAlias.userAgent||"")+(navigatorAlias.platform||"")+JSON2.stringify(browserFeatures)+nowTs).slice(0,16)}tmpContainer=[visitorUUID]}return tmpContainer[0]}function loadReferrerAttributionCookie(){var cookie=getCookie(getCookieName("ref"),"ref");if(cookie.length){try{cookie=JSON2.parse(cookie);if(isObject(cookie)){return cookie}}catch(err){}}return["","",0,""]}function _getRealSiteId(_siteId){if(_siteId!==undefined&&_siteId.length==8){return _siteId+"html"}return _siteId}function getRequest(request,customData,pluginMethod,currentEcommerceOrderTs){var i,now=new Date(),nowTs=Math.round(now.getTime()/1000),uuid,referralTs,referralUrl,referralUrlMaxLength=1024,currentReferrerHostName,originalReferrerHostName,customVariablesCopy=customVariables,idname=getCookieName("id"),sesname=getCookieName("ses"),refname=getCookieName("ref"),cvarname=getCookieName("cvar"),id=loadVisitorIdCookie(),ses=getCookie(sesname,"ses"),attributionCookie=loadReferrerAttributionCookie(),currentUrl=configCustomUrl||locationHrefAlias,campaignNameDetected,campaignKeywordDetected;if(configCookiesDisabled){configCookiesDisabled=false;setCookie(idname,"",-86400,configCookiePath,configCookieDomain);setCookie(sesname,"",-86400,configCookiePath,configCookieDomain);setCookie(cvarname,"",-86400,configCookiePath,configCookieDomain);setCookie(refname,"",-86400,configCookiePath,configCookieDomain);configCookiesDisabled=true}if(configDoNotTrack){return""}uuid=id;if(!isDefined(currentEcommerceOrderTs)){currentEcommerceOrderTs=""}var charSet=documentAlias.characterSet||documentAlias.charset;if(!charSet||charSet.toLowerCase()==="utf-8"){charSet=null}campaignNameDetected=attributionCookie[0];campaignKeywordDetected=attributionCookie[1];referralTs=attributionCookie[2];referralUrl=attributionCookie[3];if(!ses){if(!configConversionAttributionFirstReferrer||!campaignNameDetected.length){for(i in configCampaignNameParameters){if(Object.prototype.hasOwnProperty.call(configCampaignNameParameters,i)){campaignNameDetected=getParameter(currentUrl,configCampaignNameParameters[i]);if(campaignNameDetected.length){break}}}for(i in configCampaignKeywordParameters){if(Object.prototype.hasOwnProperty.call(configCampaignKeywordParameters,i)){campaignKeywordDetected=getParameter(currentUrl,configCampaignKeywordParameters[i]);if(campaignKeywordDetected.length){break}}}}currentReferrerHostName=getHostName(configReferrerUrl);originalReferrerHostName=referralUrl.length?getHostName(referralUrl):"";if(currentReferrerHostName.length&&!isSiteHostName(currentReferrerHostName)&&(!configConversionAttributionFirstReferrer||!originalReferrerHostName.length||isSiteHostName(originalReferrerHostName))){referralUrl=configReferrerUrl}if(referralUrl.length||campaignNameDetected.length){referralTs=nowTs;attributionCookie=[campaignNameDetected,campaignKeywordDetected,referralTs,purify(referralUrl.slice(0,referralUrlMaxLength))];setCookie(refname,JSON2.stringify(attributionCookie),configReferralCookieTimeout,configCookiePath,configCookieDomain)}}request.idsite=_getRealSiteId(String(configTrackerSiteId));request.lu=configUserId;request.chl=configChannelId;request.rec=1;request.r=String(Math.random()).slice(2,8);request.h=now.getHours();request.m=now.getMinutes();request.s=now.getSeconds();request.url=purify(currentUrl);request._ip=configIPAddress;if(configReferrerUrl.length){request.urlref=purify(configReferrerUrl)}if(!isDefined(request.action_name)){request.action_name=titleFixup(configTitle)}request._id=uuid;if(charSet){request.cs=charSet}if(customVariablesPage!=undefined){request.cvar=customVariablesPage}for(i in browserFeatures){if(Object.prototype.hasOwnProperty.call(browserFeatures,i)){request[i]=browserFeatures[i]}}if(customData){request.cdata=customData}else{if(configCustomData){request.cdata=configCustomData}}if(customVariables){request._cvar=customVariables;for(i in customVariablesCopy){if(Object.prototype.hasOwnProperty.call(customVariablesCopy,i)){if(customVariables[i][0]===""||customVariables[i][1]===""){delete customVariables[i]}}}setCookie(cvarname,JSON2.stringify(customVariables),configSessionCookieTimeout,configCookiePath,configCookieDomain)}setVisitorIdCookie(uuid);setCookie(sesname,"*",configSessionCookieTimeout,configCookiePath,configCookieDomain);var pluginResult=executePluginMethod(pluginMethod);if(pluginResult!=undefined&&pluginResult!=null){for(var p in pluginResult){request[p]=pluginResult[p]}}return request}function logPageView(customTitle,customData){var now=new Date();var requestExt={};requestExt.action_name=titleFixup(customTitle||configTitle);var request=getRequest(requestExt,customData,"log");sendRequest(request,configTrackerPause);if(configMinimumVisitTime&&configHeartBeatTimer&&!activityTrackingInstalled){activityTrackingInstalled=true;addEventListener(documentAlias,"click",activityHandler);addEventListener(documentAlias,"mouseup",activityHandler);addEventListener(documentAlias,"mousedown",activityHandler);addEventListener(documentAlias,"mousemove",activityHandler);addEventListener(documentAlias,"mousewheel",activityHandler);addEventListener(windowAlias,"DOMMouseScroll",activityHandler);addEventListener(windowAlias,"scroll",activityHandler);addEventListener(documentAlias,"keypress",activityHandler);addEventListener(documentAlias,"keydown",activityHandler);addEventListener(documentAlias,"keyup",activityHandler);addEventListener(windowAlias,"resize",activityHandler);addEventListener(windowAlias,"focus",activityHandler);addEventListener(windowAlias,"blur",activityHandler);lastActivityTime=now.getTime();setTimeout(function heartBeat(){var now=new Date(),request;if((lastActivityTime+configHeartBeatTimer)>now.getTime()){if(configMinimumVisitTime<now.getTime()){request={};request.ping=1;getRequest(request,customData,"ping");sendRequest(request,configTrackerPause)}setTimeout(heartBeat,configHeartBeatTimer)}},configHeartBeatTimer)}}function logSiteSearch(keyword,category,resultsCount,customData){var requestExt={};requestExt.search=keyword;if(category){requestExt.search_cat=category}if(isDefined(resultsCount)){requestExt.search_count=resultsCount}var request=getRequest(requestExt,customData,"sitesearch");sendRequest(request,configTrackerPause)}function logGoal(idGoal,customRevenue,customData){var requestExt={};requestExt.idgoal=idGoal;if(customRevenue){requestExt.revenue=customRevenue}requestExt.action_name=titleFixup(configTitle);var request=getRequest(requestExt,customData,"goal");sendRequest(request,configTrackerPause)}function logLink(url,linkType,customData){var requestExt={};requestExt[linkType]=purify(url);var request=getRequest(requestExt,customData,"link");sendRequest(request,configTrackerPause)}function logEvent(eventId,eventLabel,customData){var requestExt={};requestExt.evtId=eventId;requestExt.evtLabel=eventLabel;requestExt.action_name=titleFixup(configTitle);sendRequest(getRequest(requestExt,customData),configTrackerPause)}function logEventCustom(eventId,attributes,value,customData){var requestExt={};if(eventId!=undefined&&eventId!=""){requestExt.eid=eventId;requestExt.attr=attributes||{};var val=value||0;requestExt.val=parseFloat(val);requestExt.action_name=titleFixup(configTitle);sendRequest(getRequest(requestExt,customData),configTrackerPause)}}function logPageClick(){addEventListener(documentAlias,"mousedown",pageClickHandler,false)}function pageClickHandler(evt){var target,button;evt=evt||windowAlias.event;target=evt.target||evt.srcElement;button=evt.which||evt.button;if(evt.type==="mousedown"&&1==button){if(target){var tagName=target.tagName.toUpperCase();if(tagName=="BODY"){return}var pageClickDocument=document.documentElement&&document.documentElement.clientHeight!==0?document.documentElement:document.body;var requestParam={};var idSite=configTrackerSiteId;var currentUrl=configCustomUrl||locationHrefAlias;requestParam.idsite=_getRealSiteId(String(idSite));requestParam.name=titleFixup(configTitle);requestParam.url=purify(currentUrl);requestParam.chl=configChannelId;var w=pageClickDocument.clientWidth||window.innerWidth;var h=pageClickDocument.clientHeight||window.innerHeight;var x=evt.clientX;var y=evt.clientY;var scrollx=window.pageXOffset||pageClickDocument.scrollLeft;var scrolly=window.pageYOffset||pageClickDocument.scrollTop;var maxWidth=Math.max(pageClickDocument.scrollWidth,pageClickDocument.offsetWidth,w);var maxHeight=Math.max(pageClickDocument.scrollHeight,pageClickDocument.offsetHeight,h);if(x>w||y>h){return}x+=scrollx;y+=scrolly;if(x<0||y<0||x>maxWidth||y>maxHeight){return}requestParam.monitor_type=3;requestParam.x=x;requestParam.y=y;requestParam.w=maxWidth;requestParam.h=maxHeight;if(tagName=="IMG"){var upCount=0;while(tagName!="A"&&tagName!="AREA"&&target.parentNode!=null){target=target.parentNode;tagName=target.tagName.toUpperCase();if(++upCount==3){break}}}if(tagName=="A"||tagName=="AREA"){requestParam.linkID=String(getElementID(target));requestParam.linkTag=tagName;var linkText=typeof target.textContent=="string"?target.textContent:target.innerText;if(linkText.length>0){requestParam.linkText=linkText}if(isDefined(target.href)){var scriptProtocol=new RegExp("^(javascript|vbscript|jscript|mocha|livescript|ecmascript):","i");if(!scriptProtocol.test(target.href)){var linkhref=target.getAttribute("href",2);requestParam.linkHref=purify(linkhref)}}if(isDefined(target.alt)){requestParam.linkAlt=target.alt}}var _uuid=loadVisitorIdCookie();requestParam._id=_uuid;requestParam.lu=configUserId;sendRequest(requestParam,configTrackerPause)}}}function getMousePos(event){var e=event||window.event;var scrollX=document.documentElement.scrollLeft||document.body.scrollLeft;var scrollY=document.documentElement.scrollTop||document.body.scrollTop;var x=e.pageX||e.clientX+scrollX;var y=e.pageY||e.clientY+scrollY;return{x:x,y:y}}function prefixPropertyName(prefix,propertyName){if(prefix!==""){return prefix+propertyName.charAt(0).toUpperCase()+propertyName.slice(1)}return propertyName}function trackCallback(callback){var isPreRendered,i,prefixes=["","webkit","ms","moz"],prefix;if(!configCountPreRendered){for(i=0;i<prefixes.length;i++){prefix=prefixes[i];if(Object.prototype.hasOwnProperty.call(documentAlias,prefixPropertyName(prefix,"hidden"))){if(documentAlias[prefixPropertyName(prefix,"visibilityState")]==="prerender"){isPreRendered=true}break}}}if(isPreRendered){addEventListener(documentAlias,prefix+"visibilitychange",function ready(){documentAlias.removeEventListener(prefix+"visibilitychange",ready,false);callback()});return}callback()}function getClassesRegExp(configClasses,defaultClass){var i,classesRegExp="(^| )(ubm[_-]"+defaultClass;if(configClasses){for(i=0;i<configClasses.length;i++){classesRegExp+="|"+configClasses[i]}}classesRegExp+=")( |$)";return new RegExp(classesRegExp)}function getLinkType(className,href,isInLink){var downloadPattern=getClassesRegExp(configDownloadClasses,"download"),linkPattern=getClassesRegExp(configLinkClasses,"link"),downloadExtensionsPattern=new RegExp("\\.("+configDownloadExtensions+")([?&#]|$)","i");return linkPattern.test(className)?"link":(downloadPattern.test(className)||downloadExtensionsPattern.test(href)?"download":(isInLink?0:"link"))}function processClick(sourceElement){var parentElement,tag,linkType;while((parentElement=sourceElement.parentNode)!==null&&isDefined(parentElement)&&((tag=sourceElement.tagName.toUpperCase())!=="A"&&tag!=="AREA")){sourceElement=parentElement}if(isDefined(sourceElement.href)){var originalSourceHostName=sourceElement.hostname||getHostName(sourceElement.href),sourceHostName=originalSourceHostName.toLowerCase(),sourceHref=sourceElement.href.replace(originalSourceHostName,sourceHostName),scriptProtocol=new RegExp("^(javascript|vbscript|jscript|mocha|livescript|ecmascript|mailto):","i");if(!scriptProtocol.test(sourceHref)){linkType=getLinkType(sourceElement.className,sourceHref,isSiteHostName(sourceHostName));if(linkType){sourceHref=urldecode(sourceHref);logLink(sourceHref,linkType)}}}}function clickHandler(evt){var button,target;evt=evt||windowAlias.event;button=evt.which||evt.button;target=evt.target||evt.srcElement;if(evt.type==="click"){if(target){processClick(target)}}else{if(evt.type==="mousedown"){if((button===1||button===2)&&target){lastButton=button;lastTarget=target}else{lastButton=lastTarget=null}}else{if(evt.type==="mouseup"){if(button===lastButton&&target===lastTarget){processClick(target)}lastButton=lastTarget=null}}}}function addClickListener(element,enable){if(enable){addEventListener(element,"mouseup",clickHandler,false);addEventListener(element,"mousedown",clickHandler,false)}else{addEventListener(element,"click",clickHandler,false)}}function addClickListeners(enable){if(!linkTrackingInstalled){linkTrackingInstalled=true;var i,ignorePattern=getClassesRegExp(configIgnoreClasses,"ignore"),linkElements=documentAlias.links;if(linkElements){for(i=0;i<linkElements.length;i++){if(!ignorePattern.test(linkElements[i].className)){addClickListener(linkElements[i],enable)}}}}}function detectBrowserFeatures(){var i,mimeType,pluginMap={pdf:"application/pdf",qt:"video/quicktime",realp:"audio/x-pn-realaudio-plugin",wma:"application/x-mplayer2",dir:"application/x-director",fla:"application/x-shockwave-flash",java:"application/x-java-vm",gears:"application/x-googlegears",ag:"application/x-silverlight"},devicePixelRatio=(new RegExp("Mac OS X.*Safari/")).test(navigatorAlias.userAgent)?windowAlias.devicePixelRatio||1:1;if(!((new RegExp("MSIE")).test(navigatorAlias.userAgent))){if(navigatorAlias.mimeTypes&&navigatorAlias.mimeTypes.length){for(i in pluginMap){if(Object.prototype.hasOwnProperty.call(pluginMap,i)){mimeType=navigatorAlias.mimeTypes[pluginMap[i]];browserFeatures[i]=(mimeType&&mimeType.enabledPlugin)?"1":"0"}}}if(typeof navigator.javaEnabled!=="unknown"&&isDefined(navigatorAlias.javaEnabled)){var isJavaEnabled=false;try{isJavaEnabled=navigatorAlias.javaEnabled()}catch(error){}if(isJavaEnabled){browserFeatures.java="1"}}if(isFunction(windowAlias.GearsFactory)){browserFeatures.gears="1"}browserFeatures.cookie=hasCookies()}browserFeatures.res=screenAlias.width*devicePixelRatio+"x"+screenAlias.height*devicePixelRatio}function registerHook(hookName,userHook){var hookObj=null;if(isString(hookName)&&!isDefined(registeredHooks[hookName])&&userHook){if(isObject(userHook)){hookObj=userHook}else{if(isString(userHook)){try{eval("hookObj ="+userHook)}catch(e){}}}registeredHooks[hookName]=hookObj}return hookObj}function queryRecResult(itemId,scenarioId,callback){try{var url;var recUserId;var ti=Math.round(Math.random()*1000);if(configUserId!=""&&configUserId!=null){recUserId=configUserId}else{recUserId=loadVisitorIdCookie()}if(itemId==null){url=recResultServiceUrl+configTrackerSiteId+"/"+scenarioId+"?userId="+recUserId+"&cb="+callback+"&ti="+ti}else{url=recResultServiceUrl+configTrackerSiteId+"/"+scenarioId+"?userId="+recUserId+"&itemId="+itemId+"&cb="+callback+"&ti="+ti}var script,head=document.head||document.getElementsByTagName("head")[0]||document.documentElement;script=document.createElement("script");script.src=url;script.onload=script.onreadystatechange=function(_,isAbort){if(isAbort||!script.readyState||/loaded|complete/.test(script.readyState)){script.onload=script.onreadystatechange=null;if(head&&script.parentNode){head.removeChild(script)}script=undefined}};head.insertBefore(script,head.firstChild)}catch(e){}}detectBrowserFeatures();updateDomainHash();executePluginMethod("run",registerHook);return{hook:registeredHooks,getHook:function(hookName){return registeredHooks[hookName]},getVisitorId:function(){return loadVisitorIdCookie()},setVisitorId:function(visitorId){setVisitorIdCookie(visitorId)},getAttributionInfo:function(){return loadReferrerAttributionCookie()},getAttributionCampaignName:function(){return loadReferrerAttributionCookie()[0]},getAttributionCampaignKeyword:function(){return loadReferrerAttributionCookie()[1]},getAttributionReferrerTimestamp:function(){return loadReferrerAttributionCookie()[2]},getAttributionReferrerUrl:function(){return loadReferrerAttributionCookie()[3]},setTrackerUrl:function(trackerUrl){configTrackerUrl=trackerUrl},setSiteId:function(siteId){configTrackerSiteId=siteId},getSiteId:function(){return _getRealSiteId(String(configTrackerSiteId))},setUserInfo:function(userId){if(isDefined(userId)){configUserId=userId}},setChannelId:function(subChannel){configChannelId=subChannel},setCustomData:function(key_or_obj,opt_value){if(isObject(key_or_obj)){configCustomData=key_or_obj}else{if(!configCustomData){configCustomData={}}configCustomData[key_or_obj]=opt_value}},getCustomData:function(){return configCustomData},setCustomVariable:function(index,name,value,scope){var toRecord;if(!isDefined(scope)){scope="visit"}if(index>0){name=isDefined(name)&&!isString(name)?String(name):name;value=isDefined(value)&&!isString(value)?String(value):value;toRecord=[name.slice(0,customVariableMaximumLength),value.slice(0,customVariableMaximumLength)];if(scope==="visit"||scope===2){loadCustomVariables();customVariables[index]=toRecord}else{if(scope==="page"||scope===3){customVariablesPage[index]=toRecord}}}},getCustomVariable:function(index,scope){var cvar;if(!isDefined(scope)){scope="visit"}if(scope==="page"||scope===3){cvar=customVariablesPage[index]}else{if(scope==="visit"||scope===2){loadCustomVariables();cvar=customVariables[index]}}if(!isDefined(cvar)||(cvar&&cvar[0]==="")){return false}return cvar},deleteCustomVariable:function(index,scope){if(this.getCustomVariable(index,scope)){this.setCustomVariable(index,"","",scope)}},setLinkTrackingTimer:function(delay){configTrackerPause=delay},setDownloadExtensions:function(extensions){configDownloadExtensions=extensions},addDownloadExtensions:function(extensions){configDownloadExtensions+="|"+extensions},setDomains:function(hostsAlias){configHostsAlias=isString(hostsAlias)?[hostsAlias]:hostsAlias;configHostsAlias.push(domainAlias)},setIgnoreClasses:function(ignoreClasses){configIgnoreClasses=isString(ignoreClasses)?[ignoreClasses]:ignoreClasses},setRequestMethod:function(method){configRequestMethod=method||"GET"},setReferrerUrl:function(url){configReferrerUrl=url},setCustomUrl:function(url){configCustomUrl=resolveRelativeReference(locationHrefAlias,url)},setDocumentTitle:function(title){configTitle=title},setCustomIPAddress:function(ipaddress){configIPAddress=ipaddress},setDownloadClasses:function(downloadClasses){configDownloadClasses=isString(downloadClasses)?[downloadClasses]:downloadClasses},setLinkClasses:function(linkClasses){configLinkClasses=isString(linkClasses)?[linkClasses]:linkClasses},setCampaignNameKey:function(campaignNames){configCampaignNameParameters=isString(campaignNames)?[campaignNames]:campaignNames},setCampaignKeywordKey:function(campaignKeywords){configCampaignKeywordParameters=isString(campaignKeywords)?[campaignKeywords]:campaignKeywords},discardHashTag:function(enableFilter){configDiscardHashTag=enableFilter},setCookieNamePrefix:function(cookieNamePrefix){configCookieNamePrefix=cookieNamePrefix;customVariables=getCustomVariablesFromCookie()},setCookieDomain:function(domain){configCookieDomain=domainFixup(domain);updateDomainHash()},enableCookieSubDomain:function(enable){configCookieSubDomain=enable},setCookiePath:function(path){configCookiePath=path;updateDomainHash()},setVisitorCookieTimeout:function(timeout){configVisitorCookieTimeout=timeout*1000},setSessionCookieTimeout:function(timeout){configSessionCookieTimeout=timeout*1000},setReferralCookieTimeout:function(timeout){configReferralCookieTimeout=timeout*1000},setConversionAttributionFirstReferrer:function(enable){configConversionAttributionFirstReferrer=enable},disableCookies:function(){configCookiesDisabled=true;browserFeatures.cookie="0"},setDoNotTrack:function(enable){var dnt=navigatorAlias.doNotTrack||navigatorAlias.msDoNotTrack;configDoNotTrack=enable&&(dnt==="yes"||dnt==="1");if(configDoNotTrack){this.disableCookies()}},addListener:function(element,enable){addClickListener(element,enable)},enableLinkTracking:function(enable){if(hasLoaded){addClickListeners(enable)}else{registeredOnLoadHandlers.push(function(){addClickListeners(enable)})}},setHeartBeatTimer:function(minimumVisitLength,heartBeatDelay){var now=new Date();configMinimumVisitTime=now.getTime()+minimumVisitLength*1000;configHeartBeatTimer=heartBeatDelay*1000},enableInFrame:function(enable){if(configInFrame){configEnableInFrameTrack=enable}},redirectFile:function(url){if(windowAlias.location.protocol==="file:"){windowAlias.location=url}},setCountPreRendered:function(enable){configCountPreRendered=enable},trackGoal:function(idGoal,customRevenue,customData){trackCallback(function(){logGoal(idGoal,customRevenue,customData)})},trackLink:function(sourceUrl,linkType,customData){trackCallback(function(){logLink(sourceUrl,linkType,customData)})},setAutoPageView:function(isAuto){configAutoPageView=isAuto},getAutoPageView:function(){return configAutoPageView},trackPageView:function(customTitle,customData){trackCallback(function(){logPageView(customTitle,customData)})},trackSiteSearch:function(keyword,category,resultsCount){trackCallback(function(){logSiteSearch(keyword,category,resultsCount)})},trackEvent:function(eventId,eventLabel,customData){trackCallback(function(){logEvent(eventId,eventLabel,customData)})},eventCustom:function(eventId,attributes,value,customData){trackCallback(function(){logEventCustom(eventId,attributes,value,customData)})},eventBrowse:function(itemId,attributes,value,customData){trackCallback(function(){var eventId="BROWSE";var attr=attributes||{};if(isObject(attr)&&isDefined(itemId)){attr.itemId=itemId;logEventCustom(eventId,attr,value,customData)}})},eventCart:function(itemId,price,attributes,value,customData){trackCallback(function(){var eventId="CART";var attr=attributes||{};if(isObject(attr)&&isDefined(itemId)&&isDefined(price)){attr.itemId=itemId;attr.price=price;logEventCustom(eventId,attr,value,customData)}})},eventBuy:function(itemId,price,attributes,value,customData){trackCallback(function(){var eventId="BUY";var attr=attributes||{};if(isObject(attr)&&isDefined(itemId)&&isDefined(price)){attr.itemId=itemId;attr.price=price;logEventCustom(eventId,attr,value,customData)}})},eventShare:function(itemId,channel,attributes,value,customData){trackCallback(function(){var eventId="SHARE";var attr=attributes||{};if(isObject(attr)&&isDefined(itemId)&&isDefined(channel)){attr.itemId=itemId;attr.channel=channel;logEventCustom(eventId,attr,value,customData)}})},eventDownload:function(itemId,attributes,value,customData){trackCallback(function(){var eventId="DOWNLOAD";var attr=attributes||{};if(isObject(attr)&&isDefined(itemId)){attr.itemId=itemId;logEventCustom(eventId,attr,value,customData)}})},eventFavorite:function(itemId,attributes,value,customData){trackCallback(function(){var eventId="FAVORITE";var attr=attributes||{};if(isObject(attr)&&isDefined(itemId)){attr.itemId=itemId;logEventCustom(eventId,attr,value,customData)}})},eventRate:function(itemId,rating,attributes,value,customData){trackCallback(function(){var eventId="RATE";var attr=attributes||{};if(isObject(attr)&&isDefined(itemId)&&isDefined(rating)){attr.itemId=itemId;attr.rating=rating;logEventCustom(eventId,attr,value,customData)}})},eventSearch:function(itemId,keyword,attributes,value,customData){trackCallback(function(){var eventId="SEARCH";var attr=attributes||{};if(isObject(attr)&&isDefined(itemId)&&isDefined(keyword)){attr.itemId=itemId;attr.keyword=keyword;logEventCustom(eventId,attr,value,customData)}})},eventRecDisplay:function(itemId,modelId,scenarioId,attributes,value,customData){trackCallback(function(){var eventId="REC_DISPLAY";var attr=attributes||{};if(isObject(attr)&&isDefined(itemId)&&isDefined(modelId)&&isDefined(scenarioId)){attr.itemId=isString(itemId)?[itemId]:itemId;attr.modelId=isString(modelId)?[modelId]:modelId;attr.scenarioId=scenarioId;logEventCustom(eventId,attr,value,customData)}})},eventRecClick:function(itemId,modelId,scenarioId,attributes,value,customData){trackCallback(function(){var eventId="REC_CLICK";var attr=attributes||{};if(isObject(attr)&&isDefined(itemId)&&isDefined(modelId)&&isDefined(scenarioId)){attr.itemId=itemId;attr.modelId=modelId;attr.scenarioId=scenarioId;logEventCustom(eventId,attr,value,customData)}})},trackPageClick:function(){if(hasLoaded){logPageClick()}else{registeredOnLoadHandlers.push(function(){logPageClick()})}},queryRec:function(scenarioId,callback){queryRecResult(null,scenarioId,callback)},queryRecByItem:function(itemId,scenarioId,callback){queryRecResult(itemId,scenarioId,callback)}}}function TrackerProxy(){return{push:apply}}addEventListener(windowAlias,"message",function(e){if(e.data=="GET-SCREEN-PARAMS"){var _w=documentAlias.documentElement.scrollWidth||documentAlias.body.scrollWidth;var _h=documentAlias.documentElement.scrollHeight||documentAlias.body.scrollHeight;window.top.postMessage(_w+"-"+_h,"*")}},false);addEventListener(windowAlias,"beforeunload",beforeUnloadHandler,false);addReadyListener();Date.prototype.getTimeAlias=Date.prototype.getTime;asyncTracker=new Tracker();for(i=0;i<_paq.length;i++){if(_paq[i][0]==="setTrackerUrl"||_paq[i][0]==="setSiteId"){apply(_paq[i]);delete _paq[i]}}for(i=0;i<_paq.length;i++){if(_paq[i]){if(_paq[i][0]==="setVisitorId"||_paq[i][0]==="setUserInfo"){apply(_paq[i]);delete _paq[i]}}}var isTrackPageView=false;for(i=0;i<_paq.length;i++){if(_paq[i]){if(_paq[i][0]==="trackPageView"){isTrackPageView=true}apply(_paq[i])}}var _idSite=apply(["getSiteId"]);if(isDefined(_idSite)&&_idSite!=""){if(!isTrackPageView&&apply(["getAutoPageView"])){apply(["trackPageView"])}}_paq=new TrackerProxy();return{addPlugin:function(pluginName,pluginObj){plugins[pluginName]=pluginObj},getTracker:function(siteId,ubmUrl){return new Tracker(siteId,ubmUrl)},getAsyncTracker:function(){return asyncTracker}}}());function getElementID(e){var b=hashCode(convert(e.outerHTML));var a=e.getAttribute("href",2);var c=$(document).find("[href='"+a+"']");if(c.length>1){for(var d=0;d<c.length;d++){if(c[d]==e){b+=","+d;break}}}return b}function convert(a){return sort(a.replace(/[^0-9a-zA-Z]/g,"").toLowerCase())}function sort(a){return a.split("").sort().join("")}function hashCode(g){var d=0,f=0;var a=g.length;var b=-2147483648,e=2147483647;for(var c=0;c<a;c++){d=31*d+g.charCodeAt(f++);while(d>e){d+=b*2}while(d<b){d+=e*2}}return d}function get_previoussibling(b){var a=b.previousSibling;if(null==a){return null}while(a.nodeType!=1){a=a.previousSibling;if(null==a){return null}}return a};